<html lang="zh-CN" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡è£å‰ªå·¥å…· - å›¾ç‰‡å·¥å…·ç®±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                    },
                }
            }
        }
    </script>
</head>
<body class="h-full flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <!-- é¡¶éƒ¨é€šçŸ¥æ  -->
    <div class="bg-primary text-white text-center py-2 text-sm">
        ğŸ‰ æ–°åŠŸèƒ½ä¸Šçº¿ï¼šæ‰¹é‡å›¾ç‰‡å¤„ç†é€Ÿåº¦æå‡50%ï¼Œå¿«æ¥ä½“éªŒå§ï¼
    </div>
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="bg-gradient-to-r from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-md sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex flex-wrap justify-between items-center">
            <div class="flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                <h1 class="text-lg font-bold text-gray-800 dark:text-white">å›¾ç‰‡å·¥å…·ç®±</h1>
            </div>
            
            <!-- æ¡Œé¢ç«¯å¯¼èˆªèœå• -->
            <nav class="hidden md:flex items-center space-x-6">
                <a href="tool_website.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">é¦–é¡µ</a>
                <a href="image_compression.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">å›¾ç‰‡å‹ç¼©</a>
                <a href="image_cropping.html" class="text-primary dark:text-primary bg-primary/10 dark:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">å›¾ç‰‡è£å‰ª</a>
                <a href="format_conversion.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">æ ¼å¼è½¬æ¢</a>
                <a href="batch_processing.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">æ‰¹é‡å¤„ç†</a>
            </nav>
            
            <!-- ç§»åŠ¨ç«¯èœå•æŒ‰é’®å’Œæš—é»‘æ¨¡å¼åˆ‡æ¢ -->
            <div class="flex items-center md:order-2 space-x-2">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path id="theme-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                </button>
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- ç§»åŠ¨ç«¯å¯¼èˆªèœå• -->
        <div id="mobile-menu" class="md:hidden hidden bg-white dark:bg-gray-800 shadow-lg">
            <div class="px-4 py-2 space-y-1">
                <a href="./" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">é¦–é¡µ</a>
                <a href="image_compression.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">å›¾ç‰‡å‹ç¼©</a>
                <a href="image_cropping.html" class="block px-3 py-2 rounded-md text-base font-medium text-primary dark:text-primary bg-gray-100 dark:bg-gray-700 transition-colors duration-200">å›¾ç‰‡è£å‰ª</a>
                <a href="format_conversion.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">æ ¼å¼è½¬æ¢</a>
                <a href="batch_processing.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">æ‰¹é‡å¤„ç†</a>
            </div>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹åŒº -->
    <main class="flex-1 container mx-auto px-4 py-8">
        <div class="max-w-5xl mx-auto">
            <!-- å†…å®¹æ ‡é¢˜ -->
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-white mb-3">å›¾ç‰‡è£å‰ªå·¥å…·</h2>
                <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">è½»æ¾è£å‰ªå›¾ç‰‡åˆ°ä»»æ„å°ºå¯¸ï¼Œæ”¯æŒé¢„è®¾æ¯”ä¾‹å’Œè‡ªç”±è£å‰ªï¼Œæ»¡è¶³å„ç§åœºæ™¯éœ€æ±‚ã€‚</p>
            </div>

            <!-- å·¥å…·å†…å®¹åŒº -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 md:p-8 border border-gray-100 dark:border-gray-700 mb-8">
                <!-- ä¸Šä¼ åŒºåŸŸ -->
                <div id="upload-area" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-primary transition-colors duration-200 mb-6 bg-gray-50 dark:bg-gray-700/50">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-600 dark:text-green-400 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-2">ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æˆ–æ‹–æ”¾è‡³æ­¤å¤„</h3>
                    <p class="text-gray-500 dark:text-gray-400 text-sm mb-4">æ”¯æŒ JPGã€PNGã€WebP æ ¼å¼ï¼Œå•å¼ å›¾ç‰‡æœ€å¤§ 5MB</p>
                    <button class="inline-block px-5 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors duration-200 shadow-sm text-sm font-medium">
                        é€‰æ‹©å›¾ç‰‡
                    </button>
                    <input type="file" id="file-input" accept="image/*" class="hidden">
                </div>

                <!-- è£å‰ªè®¾ç½® -->
                <div id="cropping-settings" class="mb-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-100 dark:border-gray-700 hidden">
                    <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">è£å‰ªè®¾ç½®</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è£å‰ªæ¯”ä¾‹</label>
                            <select id="aspect-ratio" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                                <option value="free">è‡ªç”±è£å‰ª</option>
                                <option value="1:1">1:1 (æ­£æ–¹å½¢)</option>
                                <option value="4:3">4:3 (æ ‡å‡†)</option>
                                <option value="16:9">16:9 (å®½å±)</option>
                                <option value="3:2">3:2 (ç…§ç‰‡)</option>
                                <option value="custom">è‡ªå®šä¹‰</option>
                            </select>
                        </div>
                        <div id="custom-ratio-container" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è‡ªå®šä¹‰æ¯”ä¾‹ (å®½:é«˜)</label>
                            <div class="flex space-x-2">
                                <input type="number" id="custom-width" placeholder="å®½" min="1" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                                <span class="flex items-center justify-center text-gray-500 dark:text-gray-400">:</span>
                                <input type="number" id="custom-height" placeholder="é«˜" min="1" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è¾“å‡ºå®½åº¦ (åƒç´ )</label>
                            <input type="number" id="output-width" placeholder="è‡ªåŠ¨" min="1" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è¾“å‡ºé«˜åº¦ (åƒç´ )</label>
                            <input type="number" id="output-height" placeholder="è‡ªåŠ¨" min="1" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                        </div>
                    </div>
                </div>

                <!-- è£å‰ªé¢„è§ˆ -->
                <div id="cropping-preview" class="mb-6 hidden">
                    <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">è£å‰ªé¢„è§ˆ</h3>
                    <div class="relative bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden border border-gray-300 dark:border-gray-600" style="height: 400px;">
                        <img id="preview-image" src="" alt="é¢„è§ˆå›¾ç‰‡" class="absolute top-0 left-0 max-w-none max-h-none transform origin-center">
                        <!-- è£å‰ªæ¡† -->
                        <div id="crop-box" class="absolute border-2 border-primary bg-transparent cursor-move" style="width: 300px; height: 300px; top: 50px; left: 50px;">
                            <!-- è£å‰ªæ¡†æ§åˆ¶ç‚¹ -->
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full -top-2 -left-2 cursor-nwse-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full -top-2 left-1/2 transform -translate-x-1/2 cursor-ns-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full -top-2 -right-2 cursor-nesw-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full top-1/2 transform -translate-y-1/2 -left-2 cursor-ew-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full top-1/2 transform -translate-y-1/2 -right-2 cursor-ew-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full -bottom-2 -left-2 cursor-nesw-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full -bottom-2 left-1/2 transform -translate-x-1/2 cursor-ns-resize"></div>
                            <div class="absolute w-4 h-4 bg-primary border-2 border-white rounded-full -bottom-2 -right-2 cursor-nwse-resize"></div>
                        </div>
                        <!-- é®ç½©å±‚ -->
                        <div id="crop-overlay" class="absolute inset-0 bg-black/50 pointer-events-none"></div>
                    </div>
                    <div class="text-sm text-gray-600 dark:text-gray-400 mt-2 text-center">
                        <span>è£å‰ªå°ºå¯¸: <span id="crop-dimensions">300 Ã— 300</span> åƒç´ </span>
                    </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="flex flex-col sm:flex-row justify-center gap-4 mt-6">
                    <button id="crop-btn" class="inline-block px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors duration-200 shadow-sm text-sm font-medium w-full sm:w-auto hidden">
                        è£å‰ªå›¾ç‰‡
                    </button>
                    <button id="download-btn" class="inline-block px-6 py-3 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-md transition-colors duration-200 shadow-sm text-sm font-medium w-full sm:w-auto hidden">
                        ä¸‹è½½å›¾ç‰‡
                    </button>
                </div>
            </div>

            <!-- ä½¿ç”¨æç¤º -->
            <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-lg p-4 mb-6">
                <h3 class="text-lg font-medium text-blue-800 dark:text-blue-300 mb-2 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    ä½¿ç”¨æç¤º
                </h3>
                <ul class="text-blue-700 dark:text-blue-400 text-sm space-y-1 ml-7 list-disc">
                    <li>æ‹–åŠ¨è£å‰ªæ¡†å¯è°ƒæ•´ä½ç½®ï¼Œæ‹–åŠ¨æ§åˆ¶ç‚¹å¯è°ƒæ•´å¤§å°</li>
                    <li>é€‰æ‹©ä¸åŒçš„è£å‰ªæ¯”ä¾‹ä»¥æ»¡è¶³ç‰¹å®šéœ€æ±‚</li>
                    <li>è®¾ç½®è¾“å‡ºå°ºå¯¸å¯æ§åˆ¶æœ€ç»ˆå›¾ç‰‡çš„åƒç´ å¤§å°</li>
                    <li>æ‰€æœ‰å›¾ç‰‡å¤„ç†å‡åœ¨æµè§ˆå™¨ä¸­å®Œæˆï¼Œä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨</li>
                </ul>
            </div>
        </div>
    </main>

    <!-- åº•éƒ¨å£°æ˜ -->
    <footer class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border-t border-gray-200 dark:border-gray-700 py-8 mt-auto shadow-inner">
        <div class="container mx-auto px-4 text-center">
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8 mb-4 pb-4 border-b border-gray-200 dark:border-gray-700/50">
                    <a href="#" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-all duration-200 text-sm font-medium">éšç§æ”¿ç­–</a>
                    <a href="#" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-all duration-200 text-sm font-medium">ä½¿ç”¨æ¡æ¬¾</a>
                    <a href="#" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-all duration-200 text-sm font-medium">è”ç³»æˆ‘ä»¬</a>
                </div>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                &copy; 2023 å›¾ç‰‡å·¥å…·ç®±. ä¸“ä¸šçš„åœ¨çº¿å›¾ç‰‡å¤„ç†è§£å†³æ–¹æ¡ˆ.
            </p>
        </div>
    </footer>

    <script>
        // æš—é»‘æ¨¡å¼åˆ‡æ¢
        const themeToggle = document.getElementById('theme-toggle');
        const themePath = document.getElementById('theme-path');
        
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themePath.setAttribute('d', 'M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z');
        } else {
            document.documentElement.classList.remove('dark');
        }
        
        themeToggle.addEventListener('click', function() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('color-theme', 'light');
                themePath.setAttribute('d', 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('color-theme', 'dark');
                themePath.setAttribute('d', 'M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z');
            }
        });

        // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuButton.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
        });

        // ç‚¹å‡»å¯¼èˆªé“¾æ¥å…³é—­ç§»åŠ¨ç«¯èœå•
        document.querySelectorAll('#mobile-menu a').forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
            });
        });

        // å›¾ç‰‡è£å‰ªå·¥å…·åŠŸèƒ½
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('file-input');
        const croppingSettings = document.getElementById('cropping-settings');
        const croppingPreview = document.getElementById('cropping-preview');
        const previewImage = document.getElementById('preview-image');
        const cropBox = document.getElementById('crop-box');
        const cropOverlay = document.getElementById('crop-overlay');
        const cropDimensions = document.getElementById('crop-dimensions');
        const aspectRatio = document.getElementById('aspect-ratio');
        const customRatioContainer = document.getElementById('custom-ratio-container');
        const customWidth = document.getElementById('custom-width');
        const customHeight = document.getElementById('custom-height');
        const outputWidth = document.getElementById('output-width');
        const outputHeight = document.getElementById('output-height');
        const cropBtn = document.getElementById('crop-btn');
        const downloadBtn = document.getElementById('download-btn');

        // è£å‰ªæ¯”ä¾‹åˆ‡æ¢
        aspectRatio.addEventListener('change', function() {
            if (this.value === 'custom') {
                customRatioContainer.classList.remove('hidden');
            } else {
                customRatioContainer.classList.add('hidden');
            }
        });

        // ä¸Šä¼ åŒºåŸŸç‚¹å‡»äº‹ä»¶
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        // æ‹–æ”¾åŠŸèƒ½
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('border-primary');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('border-primary');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('border-primary');

            if (e.dataTransfer.files.length) {
                handleFiles(e.dataTransfer.files);
            }
        });

        // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
        fileInput.addEventListener('change', function() {
            if (this.files.length) {
                handleFiles(this.files);
            }
        });

        // å¤„ç†é€‰æ‹©çš„æ–‡ä»¶
        function handleFiles(files) {
            const file = files[0];
            if (!file.type.match('image.*')) {
                alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }

            // é¢„è§ˆå›¾ç‰‡
            const reader = new FileReader();
            reader.onload = function(e) {
                previewImage.src = e.target.result;
                croppingSettings.classList.remove('hidden');
                croppingPreview.classList.remove('hidden');
                cropBtn.classList.remove('hidden');

                // è°ƒæ•´å›¾ç‰‡å¤§å°ä»¥é€‚åº”é¢„è§ˆåŒºåŸŸ
                previewImage.onload = function() {
                    const container = document.querySelector('#cropping-preview > div');
                    const containerWidth = container.clientWidth;
                    const containerHeight = container.clientHeight;
                    const imgWidth = previewImage.naturalWidth;
                    const imgHeight = previewImage.naturalHeight;

                    // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
                    const scale = Math.min(containerWidth / imgWidth, containerHeight / imgHeight);
                    previewImage.style.width = `${imgWidth * scale}px`;
                    previewImage.style.height = `${imgHeight * scale}px`;

                    // å±…ä¸­å›¾ç‰‡
                    previewImage.style.top = `${(containerHeight - imgHeight * scale) / 2}px`;
                    previewImage.style.left = `${(containerWidth - imgWidth * scale) / 2}px`;

                    // é‡ç½®è£å‰ªæ¡†
                    resetCropBox();
                };
            };
            reader.readAsDataURL(file);

            // é‡ç½®ä¸‹è½½æŒ‰é’®
            downloadBtn.classList.add('hidden');
        }

        // é‡ç½®è£å‰ªæ¡†
        function resetCropBox() {
            const container = document.querySelector('#cropping-preview > div');
            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight;

            // è®¾ç½®è£å‰ªæ¡†åˆå§‹å¤§å°ä¸ºå®¹å™¨çš„70%
            const boxSize = Math.min(containerWidth, containerHeight) * 0.7;
            cropBox.style.width = `${boxSize}px`;
            cropBox.style.height = `${boxSize}px`;

            // å±…ä¸­è£å‰ªæ¡†
            cropBox.style.top = `${(containerHeight - boxSize) / 2}px`;
            cropBox.style.left = `${(containerWidth - boxSize) / 2}px`;

            // æ›´æ–°è£å‰ªå°ºå¯¸æ˜¾ç¤º
            cropDimensions.textContent = `${Math.round(boxSize)} Ã— ${Math.round(boxSize)}`;
        }

        // è£å‰ªåŠŸèƒ½
        cropBtn.addEventListener('click', function() {
            if (!previewImage.src) {
                alert('è¯·å…ˆä¸Šä¼ å›¾ç‰‡');
                return;
            }

            this.disabled = true;
            this.textContent = 'è£å‰ªä¸­...';

            // æ¨¡æ‹Ÿè£å‰ªè¿‡ç¨‹
            setTimeout(() => {
                // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šä½¿ç”¨Canvas APIè¿›è¡Œå›¾ç‰‡è£å‰ª
                // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿè£å‰ªæ•ˆæœ

                // æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
                downloadBtn.classList.remove('hidden');

                // æ¢å¤æŒ‰é’®çŠ¶æ€
                this.disabled = false;
                this.textContent = 'è£å‰ªå›¾ç‰‡';
            }, 1000);
        });

        // ä¸‹è½½å›¾ç‰‡
        downloadBtn.addEventListener('click', function() {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šä¸‹è½½è£å‰ªåçš„å›¾ç‰‡
            // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿä¸‹è½½
            alert('å›¾ç‰‡ä¸‹è½½åŠŸèƒ½å°†åœ¨å®é™…å®ç°æ—¶æ·»åŠ ');
        });

        // è£å‰ªæ¡†æ‹–åŠ¨å’Œè°ƒæ•´å¤§å°åŠŸèƒ½
        // æ³¨æ„ï¼šè¿™é‡Œåªæ˜¯åŸºæœ¬çš„UIå®ç°ï¼Œå®Œæ•´åŠŸèƒ½éœ€è¦æ›´å¤æ‚çš„ä»£ç 
        let isDragging = false;
        let isResizing = false;
        let startX, startY, startWidth, startHeight;

        // è£å‰ªæ¡†æ‹–åŠ¨
        cropBox.addEventListener('mousedown', function(e) {
            if (e.target === cropBox || e.target.parentElement === cropBox && !e.target.classList.contains('cursor-ew-resize') && !e.target.classList.contains('cursor-ns-resize') && !e.target.classList.contains('cursor-nwse-resize') && !e.target.classList.contains('cursor-nesw-resize')) {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                startLeft = parseInt(cropBox.style.left || 0);
                startTop = parseInt(cropBox.style.top || 0);
                document.body.style.cursor = 'move';
                e.preventDefault();
            }
        });

        // çª—å£é¼ æ ‡ç§»åŠ¨
        document.addEventListener('mousemove', function(e) {
            if (isDragging) {
                const container = document.querySelector('#cropping-preview > div');
                const containerRect = container.getBoundingClientRect();
                const newLeft = startLeft + (e.clientX - startX);
                const newTop = startTop + (e.clientY - startY);
                const boxWidth = parseInt(cropBox.style.width || 0);
                const boxHeight = parseInt(cropBox.style.height || 0);

                // é™åˆ¶åœ¨å®¹å™¨å†…
                cropBox.style.left = `${Math.max(0, Math.min(newLeft, containerRect.width - boxWidth))}px`;
                cropBox.style.top = `${Math.max(0, Math.min(newTop, containerRect.height - boxHeight))}px`;
            }
        });

        // çª—å£é¼ æ ‡é‡Šæ”¾
        document.addEventListener('mouseup', function() {
            isDragging = false;
            isResizing = false;
            document.body.style.cursor = '';
        });
    </script>
</body>
</html>