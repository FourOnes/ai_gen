<html lang="zh-CN" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>格式转换工具 - 图片工具箱</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                    },
                }
            }
        }
    </script>
</head>
<body class="h-full flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <!-- 顶部通知栏 -->
    <div class="bg-primary text-white text-center py-2 text-sm">
        🎉 新功能上线：批量图片处理速度提升50%，快来体验吧！
    </div>
    <!-- 顶部导航 -->
    <header class="bg-gradient-to-r from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-md sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex flex-wrap justify-between items-center">
            <div class="flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                <h1 class="text-lg font-bold text-gray-800 dark:text-white">图片工具箱</h1>
            </div>
            
            <!-- 桌面端导航菜单 -->
            <nav class="hidden md:flex items-center space-x-6">
                <a href="./" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">首页</a>
                <a href="image_compression.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">图片压缩</a>
                <a href="image_cropping.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">图片裁剪</a>
                <a href="format_conversion.html" class="text-primary dark:text-primary bg-primary/10 dark:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">格式转换</a>
                <a href="batch_processing.html" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 px-3 py-2 rounded-md transition-all duration-200">批量处理</a>
            </nav>
            
            <!-- 移动端菜单按钮和暗黑模式切换 -->
            <div class="flex items-center md:order-2 space-x-2">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path id="theme-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                </button>
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- 移动端导航菜单 -->
        <div id="mobile-menu" class="md:hidden hidden bg-white dark:bg-gray-800 shadow-lg">
            <div class="px-4 py-2 space-y-1">
                <a href="tool_website.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">首页</a>
                <a href="image_compression.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">图片压缩</a>
                <a href="image_cropping.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">图片裁剪</a>
                <a href="format_conversion.html" class="block px-3 py-2 rounded-md text-base font-medium text-primary dark:text-primary bg-gray-100 dark:bg-gray-700 transition-colors duration-200">格式转换</a>
                <a href="batch_processing.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">批量处理</a>
            </div>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="flex-1 container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- 内容标题 -->
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-white mb-3">格式转换工具</h2>
                <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">将图片在JPG、PNG、WebP、GIF等多种格式间自由转换，保持最佳质量。</p>
            </div>

            <!-- 工具内容区 -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 md:p-8 border border-gray-100 dark:border-gray-700 mb-8">
                <!-- 上传区域 -->
                <div id="upload-area" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-primary transition-colors duration-200 mb-6 bg-gray-50 dark:bg-gray-700/50">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-purple-600 dark:text-purple-400 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-2">点击上传图片或拖放至此处</h3>
                    <p class="text-gray-500 dark:text-gray-400 text-sm mb-4">支持 JPG、PNG、WebP、GIF 格式，单张图片最大 5MB</p>
                    <button class="inline-block px-5 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-md transition-colors duration-200 shadow-sm text-sm font-medium">
                        选择图片
                    </button>
                    <input type="file" id="file-input" accept="image/*" class="hidden" multiple>
                </div>

                <!-- 转换选项 -->
                <div id="conversion-settings" class="mb-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-100 dark:border-gray-700 hidden">
                    <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">转换设置</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">输出格式</label>
                            <select id="output-format" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                                <option value="jpg">JPG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                                <option value="gif">GIF</option>
                            </select>
                        </div>
                        <div id="quality-container">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">输出质量 (仅JPG和WebP格式)</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="quality" min="1" max="100" value="80" class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary">
                                <span id="quality-value" class="text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[3rem] text-right">80%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 图片预览 -->
                <div id="preview-container" class="mb-6 hidden">
                    <div class="flex flex-col md:flex-row gap-6">
                        <div class="w-full md:w-1/2">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">原图预览</h3>
                            <div class="aspect-w-1 aspect-h-1 bg-gray-100 dark:bg-gray-700 rounded-md overflow-hidden mb-2">
                                <img id="original-image" src="" alt="原图预览" class="object-contain w-full h-auto max-h-[300px]">
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 flex justify-between">
                                <span>文件类型: <span id="original-format">--</span></span>
                                <span>文件大小: <span id="original-size">--</span></span>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">转换后预览</h3>
                            <div class="aspect-w-1 aspect-h-1 bg-gray-100 dark:bg-gray-700 rounded-md overflow-hidden mb-2">
                                <img id="converted-image" src="" alt="转换后预览" class="object-contain w-full h-auto max-h-[300px]">
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 flex justify-between">
                                <span>文件类型: <span id="converted-format">--</span></span>
                                <span>文件大小: <span id="converted-size">--</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 操作按钮 -->
                <div class="flex flex-col sm:flex-row justify-center gap-4 mt-6">
                    <button id="convert-btn" class="inline-block px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-md transition-colors duration-200 shadow-sm text-sm font-medium w-full sm:w-auto hidden">
                        开始转换
                    </button>
                    <button id="download-btn" class="inline-block px-6 py-3 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-md transition-colors duration-200 shadow-sm text-sm font-medium w-full sm:w-auto hidden">
                        下载图片
                    </button>
                </div>
            </div>

            <!-- 使用提示 -->
            <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-lg p-4 mb-6">
                <h3 class="text-lg font-medium text-blue-800 dark:text-blue-300 mb-2 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    使用提示
                </h3>
                <ul class="text-blue-700 dark:text-blue-400 text-sm space-y-1 ml-7 list-disc">
                    <li>转换质量越高，文件越大，但图像质量更好</li>
                    <li>WebP 格式通常能提供更好的压缩效果</li>
                    <li>GIF 格式支持动画，但可能导致文件较大</li>
                    <li>所有图片处理均在浏览器中完成，不会上传到服务器</li>
                </ul>
            </div>
        </div>
    </main>

    <!-- 底部声明 -->
    <footer class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border-t border-gray-200 dark:border-gray-700 py-8 mt-auto shadow-inner">
        <div class="container mx-auto px-4 text-center">
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8 mb-4 pb-4 border-b border-gray-200 dark:border-gray-700/50">
                    <a href="#" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-all duration-200 text-sm font-medium">隐私政策</a>
                    <a href="#" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-all duration-200 text-sm font-medium">使用条款</a>
                    <a href="#" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-all duration-200 text-sm font-medium">联系我们</a>
                </div>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                &copy; 2023 图片工具箱. 专业的在线图片处理解决方案.
            </p>
        </div>
    </footer>

    <script>
        // 暗黑模式切换
        const themeToggle = document.getElementById('theme-toggle');
        const themePath = document.getElementById('theme-path');
        
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themePath.setAttribute('d', 'M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z');
        } else {
            document.documentElement.classList.remove('dark');
        }
        
        themeToggle.addEventListener('click', function() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('color-theme', 'light');
                themePath.setAttribute('d', 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('color-theme', 'dark');
                themePath.setAttribute('d', 'M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z');
            }
        });

        // 移动端菜单切换
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuButton.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
        });

        // 点击导航链接关闭移动端菜单
        document.querySelectorAll('#mobile-menu a').forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
            });
        });

        // 格式转换工具功能
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('file-input');
        const conversionSettings = document.getElementById('conversion-settings');
        const previewContainer = document.getElementById('preview-container');
        const originalImage = document.getElementById('original-image');
        const convertedImage = document.getElementById('converted-image');
        const originalFormat = document.getElementById('original-format');
        const originalSize = document.getElementById('original-size');
        const convertedFormat = document.getElementById('converted-format');
        const convertedSize = document.getElementById('converted-size');
        const outputFormat = document.getElementById('output-format');
        const qualityInput = document.getElementById('quality');
        const qualityValue = document.getElementById('quality-value');
        const qualityContainer = document.getElementById('quality-container');
        const convertBtn = document.getElementById('convert-btn');
        const downloadBtn = document.getElementById('download-btn');

        // 质量滑块更新
        qualityInput.addEventListener('input', function() {
            qualityValue.textContent = `${this.value}%`;
        });

        // 输出格式切换
        outputFormat.addEventListener('change', function() {
            if (this.value === 'png' || this.value === 'gif') {
                qualityContainer.classList.add('opacity-50', 'pointer-events-none');
            } else {
                qualityContainer.classList.remove('opacity-50', 'pointer-events-none');
            }
        });

        // 上传区域点击事件
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        // 拖放功能
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('border-primary');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('border-primary');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('border-primary');

            if (e.dataTransfer.files.length) {
                handleFiles(e.dataTransfer.files);
            }
        });

        // 文件选择事件
        fileInput.addEventListener('change', function() {
            if (this.files.length) {
                handleFiles(this.files);
            }
        });

        // 处理选择的文件
        function handleFiles(files) {
            const file = files[0];
            if (!file.type.match('image.*')) {
                alert('请选择图片文件');
                return;
            }

            // 显示文件信息
            const fileType = file.type.split('/')[1].toUpperCase();
            originalFormat.textContent = fileType;
            originalSize.textContent = formatFileSize(file.size);

            // 预览图片
            const reader = new FileReader();
            reader.onload = function(e) {
                originalImage.src = e.target.result;
                convertedImage.src = e.target.result;
                conversionSettings.classList.remove('hidden');
                previewContainer.classList.remove('hidden');
                convertBtn.classList.remove('hidden');

                // 更新转换后格式显示
                updateConvertedInfo();
            };
            reader.readAsDataURL(file);

            // 重置下载按钮
            downloadBtn.classList.add('hidden');
        }

        // 更新转换后信息
        function updateConvertedInfo() {
            const format = outputFormat.value.toUpperCase();
            convertedFormat.textContent = format;
            convertedSize.textContent = '转换后显示';
        }

        // 转换图片
        convertBtn.addEventListener('click', function() {
            if (!originalImage.src) {
                alert('请先上传图片');
                return;
            }

            this.disabled = true;
            this.textContent = '转换中...';

            // 模拟转换过程
            setTimeout(() => {
                const format = outputFormat.value;
                const quality = parseInt(qualityInput.value) / 100;

                // 在实际应用中，这里会使用Canvas API进行图片格式转换
                // 这里只是模拟转换效果
                updateConvertedInfo();

                // 显示下载按钮
                downloadBtn.classList.remove('hidden');

                // 恢复按钮状态
                this.disabled = false;
                this.textContent = '开始转换';
            }, 1000);
        });

        // 下载图片
        downloadBtn.addEventListener('click', function() {
            if (!convertedImage.src) {
                alert('没有可下载的图片');
                return;
            }

            // 在实际应用中，这里会下载转换后的图片
            // 这里只是模拟下载
            const format = outputFormat.value;
            alert(`图片将以${format.toUpperCase()}格式下载，功能将在实际实现时添加`);
        });

        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' KB';
            else return (bytes / 1048576).toFixed(2) + ' MB';
        }
    </script>
</body>
</html>